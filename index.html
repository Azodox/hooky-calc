<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <title>- UwU's Calc -</title>
</head>
<body>
    <div id="drinks">
        <div id="iced-drink">
            <h2 class="category-name">Boissons glacées</h2>
            <div id="iced-coffee-container">
                <p class="object-name">Café Glacé (cg)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="vanilla-iced-coffee-container">
                <p class="object-name">Café Glacé Vanille (cgv)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="caramel-iced-coffee-container">
                <p class="object-name">Café Glacé Caramel (cgc)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
        </div>
        <div id="hot-drink">
            <h2 class="category-name">Boissons chaudes</h2>
            <div id="coffee-container">
                <p class="object-name">Café simple (c)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="decaffeinated-coffee-container">
                <p class="object-name">Café décaféïné (cd)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="cappuccino-coffee-container">
                <p class="object-name">Cappuccino (ca)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="latte-coffee-container">
                <p class="object-name">Café Latte (cl)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="americano-container">
                <p class="object-name">Americano (a)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="moka-container">
                <p class="object-name">Moka (m)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="hot-chocolate-container">
                <p class="object-name">Chocolat chaud (cc)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
        </div>
        <div id="pastry-container">
            <h2 class="category-name">Viennoiseries</h2>
            <div id="chocolatine-container">
                <p class="object-name">Chocolatine (ch)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="croissant-container">
                <p class="object-name">Croissant (cr)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
            <div id="muffins-container">
                <p class="object-name">Muffins (mf)</p>
                <input type="number" name="amount" step="1" value="0" class="amount" min="0">
            </div>
        </div>
    </div>
    <div class="option-container">
        <input type="checkbox" name="livraison" id="delivery" class="option" onclick="onCheck(this);">
        <label for="livraison">Livraison</label><br>
        <input type="checkbox" name="partenariat" id="partnership" class="option" value="Partenariat" onclick="onCheck(this);">
        <label for="partenariat">Partenariat</label><br>
        <input type="checkbox" name="entreprise" id="company" class="option" value="Entreprise" onclick="onCheck(this);">
        <label for="entreprise">Entreprise</label>
    </div>
    <input type="button" value="Calculer" id="calculate-button"><br><br>
    <div id="result-container">
        <p id="result">Résultat : <span id="total">0</span></p>
        <p>Résumé</p><textarea name="sum" id="sum" cols="50" rows="5" readonly="readonly"></textarea>
    </div>
    
    <script type="text/javascript">
        var company = document.getElementById("company")
        var partnership = document.getElementById("partnership")

        function onCheck(element){
            if(element.id == "partnership"){
                company.checked = false
            }else if(element.id == "company"){
                partnership.checked = false;
            }
        }
    </script>
    <script type="text/javascript">
        var calculate = document.getElementById('calculate-button')
        var drinksContainer = Array.from(document.getElementById('drinks').children)
        var partnership = document.getElementById('partnership')
        var company = document.getElementById('company')
        var result = document.getElementById('total')
        var sum = document.getElementById('sum')

        var data = '{"drinks":[{"iced_coffee":{"normal":50,"delivery":60},"vanilla_iced_coffee":{"normal":65,"delivery":75},"caramel_iced_coffee":{"normal":65,"delivery":75},"coffee":{"normal":40,"delivery":50},"decaffeinated_coffee":{"normal":40,"delivery":50},"cappuccino_coffee":{"normal":50,"delivery":60},"latte_coffee":{"normal":45,"delivery":55},"americano":{"normal":45,"delivery":55},"moka":{"normal":50,"delivery":60},"hot_chocolate":{"normal":55,"delivery":65},"chocolatine":{"normal":45,"delivery":55},"croissant":{"normal":35,"delivery":45},"muffins":{"normal":40,"delivery":50}}]}'
        var prices = JSON.parse(data)

        var simplifiedData = '{"coffee":"c","decaffeinated_coffee":"cd","cappuccino_coffee":"ca","latte_coffee":"cl","americano":"a","moka":"m","hot_chocolate":"cc","iced_coffee":"cg","vanilla_iced_coffee":"cgv","caramel_iced_coffee":"cgc","chocolatine":"ch","croissant":"cr","muffins":"mf"}'
        var simplified = JSON.parse(simplifiedData)

        calculate.addEventListener('click', function(e) {
            var delivery = document.getElementById("delivery").checked
            var total = 0;
            var summary = "";
            drinksContainer.forEach(function(drinks) {
                if(drinks.children){
                    Array.from(drinks.children).forEach(function(drink) {
                        if(drink.children){
                            Array.from(drink.children).forEach(function(d){
                                if(d.tagName == 'INPUT'){
                                    var price = prices['drinks'][0][d.parentElement.id.replace("-container", "").replaceAll("-", "_")]
                                    total += d.value * price[delivery ? 'delivery' : 'normal']
                                    if(d.value != 0) summary += d.value + simplified[d.parentElement.id.replace("-container", "").replaceAll("-", "_")] + " "
                                }
                            })
                        }
                    })
                }
            })
            if(partnership.checked || company.checked){
                total *= 0.9
            }
            result.innerText = total
            sum.innerText = summary
        })
    </script>
</body>
</html>